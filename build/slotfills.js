(()=>{"use strict";const e=window.wp.element,t=window.wp.i18n,l=window.wp.plugins,a=window.wp.date,n=window.wp.coreData,i=window.wp.editPost;function r(e){return!isNaN(Date.parse(e))}function o(e){return e.toString().padStart(2,"0")}const s=window.wp.components,m=l=>{let{label:n,date:i,onDateChange:r}=l;const m=new Date,u=i||m,[_,c]=(0,e.useState)((0,a.format)("m",u)),[v,p]=(0,e.useState)((0,a.format)("d",u)),[d,g]=(0,e.useState)((0,a.format)("Y",u));return(0,e.useEffect)((()=>{r(d&&_&&v?d+"-"+_+"-"+v:"")}),[_,v,d]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.BaseControl,null,(0,e.createElement)(s.BaseControl.VisualLabel,null,n),(0,e.createElement)(s.Flex,null,(0,e.createElement)(s.FlexItem,{style:{flexGrow:"1"}},(0,e.createElement)(s.SelectControl,{options:[{value:"01",label:"January"},{value:"02",label:"February"},{value:"03",label:"March"},{value:"04",label:"April"},{value:"05",label:"May"},{value:"06",label:"June"},{value:"07",label:"July"},{value:"08",label:"August"},{value:"09",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],value:_,onChange:e=>c(e),style:{height:"36px"},__nextHasNoMarginBottom:!0})),(0,e.createElement)(s.__experimentalNumberControl,{label:(0,t.__)("Day","festival"),hideLabelFromVision:!0,spinControls:"none",min:"1",max:"31",onChange:e=>p(o(e)),value:v,className:"day-input",style:{width:"36px",height:"36px",textAlign:"center"}}),(0,e.createElement)(s.__experimentalNumberControl,{label:(0,t.__)("Year","festival"),hideLabelFromVision:!0,spinControls:"none",min:(0,a.format)("Y",m),max:"9999",onChange:e=>g(e),value:d,style:{width:"56px",height:"36px",textAlign:"center"}}))))},u=l=>{let{label:n,time:i,onTimeChange:r}=l;const m=new Date,u=i||m,[_,c]=(0,e.useState)((0,a.format)("h",u)),[v,p]=(0,e.useState)((0,a.format)("i",u)),[d,g]=(0,e.useState)((0,a.format)("A",u));return(0,e.useEffect)((()=>{r(_&&v&&d?function(e){const t=e.slice(-2),l=e.slice(0,-2).split(":");return"AM"===t&&"12"===l[0]?l[0]="00":"PM"===t&&(l[0]=l[0]%12+12),l.join(":").replace(/\s+/g,"")}(_+":"+v+" "+d):"")}),[_,v,d]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.BaseControl,{className:"festival-time-input"},(0,e.createElement)(s.BaseControl.VisualLabel,null,n),(0,e.createElement)(s.Flex,{justify:"flex-start"},(0,e.createElement)(s.Flex,{gap:"0",style:{width:"auto"}},(0,e.createElement)(s.__experimentalNumberControl,{label:(0,t.__)("Hour","festival"),className:"input-hour",hideLabelFromVision:!0,spinControls:"none",min:"1",max:"12",onChange:e=>c(o(e)),value:_,style:{height:"36px"}}),(0,e.createElement)("div",{className:"input-separator"},":"),(0,e.createElement)(s.__experimentalNumberControl,{label:(0,t.__)("Minutes","festival"),className:"input-minutes",hideLabelFromVision:!0,spinControls:"none",min:"0",max:"59",onChange:e=>p(o(e)),value:v,style:{height:"36px"}})),(0,e.createElement)(s.ButtonGroup,null,(0,e.createElement)(s.Button,{variant:"AM"===d?"primary":"secondary",onClick:()=>g("AM")},(0,t.__)("AM","festival")),(0,e.createElement)(s.Button,{variant:"PM"===d?"primary":"secondary",onClick:()=>g("PM")},(0,t.__)("PM","festival"))))))};(0,l.registerPlugin)("festival-event-date-time-panel",{render:()=>{const[l,o]=(0,n.useEntityProp)("postType","festival_events","meta"),_=(e,t)=>{o({...l,[e]:t})},c=l.event_start_datetime,v=l.event_end_datetime,p=l.event_all_day,d=l.event_multi_day,[g,b]=(0,e.useState)(r(c)?(0,a.date)("Y-m-d",c):""),[f,E]=(0,e.useState)(r(c)?(0,a.date)("H:i:s",c):"00:00:00"),[h,C]=(0,e.useState)(r(v)?(0,a.date)("Y-m-d",v):""),[y,x]=(0,e.useState)(r(v)?(0,a.date)("H:i:s",v):"00:00:00"),w=d?"multi":"single";return(0,e.useEffect)((()=>{const e=f&&!p?f:"00:00:00",t=(0,a.date)("Y-m-d H:i:s",g+" "+e);r(t)&&_("event_start_datetime",t)}),[g,f,d,p]),(0,e.useEffect)((()=>{const e=y||"00:00",t=(d?h:g)||"",l=(0,a.date)("Y-m-d H:i:s",t+" "+e);r(l)&&_("event_end_datetime",l)}),[h,y,d,p]),(0,e.createElement)(i.PluginDocumentSettingPanel,{name:"festival-event-meta",title:(0,t.__)("Date & Time","festival"),className:"festival-event-date-time"},(0,e.createElement)(s.__experimentalToggleGroupControl,{label:(0,t.__)("Single or Multi-Day Event"),value:w,isBlock:!0,hideLabelFromVision:!0,onChange:e=>{_("event_multi_day","multi"===e)}},(0,e.createElement)(s.__experimentalToggleGroupControlOption,{value:"single",label:"Single Day"}),(0,e.createElement)(s.__experimentalToggleGroupControlOption,{value:"multi",label:"Multiple Day"})),(0,e.createElement)(m,{label:(0,t.__)("Start Date","festival"),date:c,onDateChange:e=>b(e)}),!1===l.event_multi_day?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.ToggleControl,{label:(0,t.__)("All Day","festival"),checked:l.event_all_day,onChange:e=>_("event_all_day",e)}),!1===l.event_all_day?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(u,{label:(0,t.__)("Start Time","festival"),time:c,onTimeChange:e=>E(e)}),(0,e.createElement)(u,{label:(0,t.__)("End Time","festival"),time:v,onTimeChange:e=>x(e)})):null):(0,e.createElement)(m,{label:(0,t.__)("End Date","festival"),date:v,onDateChange:e=>C(e),min:g}))}}),(0,l.registerPlugin)("festival-event-location-panel",{render:()=>{const[l,a]=(0,n.useEntityProp)("postType","festival_events","meta"),r=(e,t)=>{a({...l,[e]:t})};return(0,e.createElement)(i.PluginDocumentSettingPanel,{name:"festival-event-meta",title:(0,t.__)("Location","festival"),className:"festival-event-meta"},(0,e.createElement)(s.TextareaControl,{value:l.event_location,onChange:e=>r("event_location",e),label:(0,t.__)("Location Details","festival")}),(0,e.createElement)(s.TextControl,{value:l.event_url,onChange:e=>r("event_url",e),label:(0,t.__)("URL","festival"),type:"url"}),(0,e.createElement)(s.TextControl,{value:l.event_url_label,onChange:e=>r("event_url_label",e),label:(0,t.__)("Link Label","festival"),help:(0,t.__)("Enter a short label to use as link text.","festival")}))}})})();